{
  "version": 3,
  "sources": ["../../nuqs/dist/chunk-TCMXVJZC.js", "../../nuqs/dist/adapters/react.js"],
  "sourcesContent": ["import { error, debug } from './chunk-5WWTJYGR.js';\n\n// src/adapters/lib/patch-history.ts\nvar historyUpdateMarker = \"__nuqs__\";\nfunction getSearchParams(url) {\n  if (url instanceof URL) {\n    return url.searchParams;\n  }\n  if (url.startsWith(\"?\")) {\n    return new URLSearchParams(url);\n  }\n  try {\n    return new URL(url, location.origin).searchParams;\n  } catch {\n    return new URLSearchParams(url);\n  }\n}\nfunction patchHistory(emitter, adapter) {\n  if (typeof history === \"undefined\") {\n    return;\n  }\n  if (history.nuqs?.version && history.nuqs.version !== \"0.0.0-inject-version-here\") {\n    console.error(\n      error(409),\n      history.nuqs.version,\n      `0.0.0-inject-version-here`,\n      adapter\n    );\n    return;\n  }\n  if (history.nuqs?.adapters?.includes(adapter)) {\n    return;\n  }\n  let lastSearchSeen = typeof location === \"object\" ? location.search : \"\";\n  emitter.on(\"update\", (search) => {\n    const searchString = search.toString();\n    lastSearchSeen = searchString.length ? \"?\" + searchString : \"\";\n  });\n  debug(\n    \"[nuqs %s] Patching history (%s adapter)\",\n    \"0.0.0-inject-version-here\",\n    adapter\n  );\n  function sync(url) {\n    try {\n      const newSearch = new URL(url, location.origin).search;\n      if (newSearch === lastSearchSeen) {\n        return;\n      }\n    } catch {\n    }\n    try {\n      emitter.emit(\"update\", getSearchParams(url));\n    } catch (e) {\n      console.error(e);\n    }\n  }\n  const originalPushState = history.pushState;\n  const originalReplaceState = history.replaceState;\n  history.pushState = function nuqs_pushState(state, marker, url) {\n    originalPushState.call(history, state, \"\", url);\n    if (url && marker !== historyUpdateMarker) {\n      sync(url);\n    }\n  };\n  history.replaceState = function nuqs_replaceState(state, marker, url) {\n    originalReplaceState.call(history, state, \"\", url);\n    if (url && marker !== historyUpdateMarker) {\n      sync(url);\n    }\n  };\n  history.nuqs = history.nuqs ?? {\n    // This will be replaced by the prepack script\n    version: \"0.0.0-inject-version-here\",\n    adapters: []\n  };\n  history.nuqs.adapters.push(adapter);\n}\n\nexport { historyUpdateMarker, patchHistory };\n", "'use client';\n\nimport { patchHistory } from '../chunk-TCMXVJZC.js';\nimport { createAdapterProvider, renderQueryString } from '../chunk-5WWTJYGR.js';\nimport mitt from 'mitt';\nimport { createContext, useContext, useState, useEffect, useMemo, createElement } from 'react';\n\nvar emitter = mitt();\nfunction generateUpdateUrlFn(fullPageNavigationOnShallowFalseUpdates) {\n  return function updateUrl(search, options) {\n    const url = new URL(location.href);\n    url.search = renderQueryString(search);\n    if (fullPageNavigationOnShallowFalseUpdates && options.shallow === false) {\n      const method = options.history === \"push\" ? location.assign : location.replace;\n      method.call(location, url);\n    } else {\n      const method = options.history === \"push\" ? history.pushState : history.replaceState;\n      method.call(history, history.state, \"\", url);\n    }\n    emitter.emit(\"update\", search);\n    if (options.scroll === true) {\n      window.scrollTo({ top: 0 });\n    }\n  };\n}\nvar NuqsReactAdapterContext = createContext({\n  fullPageNavigationOnShallowFalseUpdates: false\n});\nfunction useNuqsReactAdapter() {\n  const { fullPageNavigationOnShallowFalseUpdates } = useContext(\n    NuqsReactAdapterContext\n  );\n  const [searchParams, setSearchParams] = useState(() => {\n    if (typeof location === \"undefined\") {\n      return new URLSearchParams();\n    }\n    return new URLSearchParams(location.search);\n  });\n  useEffect(() => {\n    const onPopState = () => {\n      setSearchParams(new URLSearchParams(location.search));\n    };\n    emitter.on(\"update\", setSearchParams);\n    window.addEventListener(\"popstate\", onPopState);\n    return () => {\n      emitter.off(\"update\", setSearchParams);\n      window.removeEventListener(\"popstate\", onPopState);\n    };\n  }, []);\n  const updateUrl = useMemo(\n    () => generateUpdateUrlFn(fullPageNavigationOnShallowFalseUpdates),\n    [fullPageNavigationOnShallowFalseUpdates]\n  );\n  return {\n    searchParams,\n    updateUrl\n  };\n}\nvar NuqsReactAdapter = createAdapterProvider(useNuqsReactAdapter);\nfunction NuqsAdapter({\n  children,\n  fullPageNavigationOnShallowFalseUpdates = false\n}) {\n  return createElement(\n    NuqsReactAdapterContext.Provider,\n    { value: { fullPageNavigationOnShallowFalseUpdates } },\n    createElement(NuqsReactAdapter, null, children)\n  );\n}\nfunction enableHistorySync() {\n  patchHistory(emitter, \"react\");\n}\n\nexport { NuqsAdapter, enableHistorySync };\n"],
  "mappings": "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",
  "names": ["emitter"]
}
